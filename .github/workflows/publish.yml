name: Wheel building

on:
  schedule:
    # run every day at 4am UTC
    - cron: '0 4 * * *'
  workflow_dispatch:
  push:
  pull_request:

jobs:

  test_wheel_building:
    # This ensures that a couple of targets work fine in pull requests and pushes
    uses: OpenAstronomy/github-actions-workflows/.github/workflows/publish.yml@v1
    if: (github.event_name == 'push' || github.event_name == 'pull_request')
    with:
      upload_to_pypi: false
      upload_to_anaconda: false
      test_extras: test
      test_command: pytest -v -p no:warnings --astropy-header -m "not hypothesis" -k "not test_data_out_of_range and not test_wcsapi_extension and not test_set_locale" --pyargs astropy
      targets: |
        - cp38-musllinux_x86_64
        - cp39-musllinux_x86_64
        - cp310-musllinux_x86_64
        - cp38-musllinux_x86_64
        - cp39-musllinux_x86_64
        - cp310-musllinux_x86_64
        - cp38-musllinux_x86_64
        - cp39-musllinux_x86_64
        - cp310-musllinux_x86_64
        - cp38-musllinux_x86_64
        - cp39-musllinux_x86_64
        - cp310-musllinux_x86_64
